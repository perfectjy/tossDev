var now=new Date();var deStartYear=now.getFullYear()-2;var deEndYear=now.getFullYear()+20;var deStartMonth=1;var deEndMonth=12;var deStartDay=1;var deEndDay=(new Date(now.getFullYear(),now.getMonth()+1,0)).getDate();var myScroll;var myScroll2;var myScroll3;var dateObj;var dateFoucsObj;$(document).ready(function(){if($(".cDatepicker").attr("class")!=undefined){$(".cDatepicker").each(function(){$(this).after('&nbsp;<a href="#none" onclick="startDate(this);" title="달력 팝업 새창으로 열림"><img src="https://mdirect.hi.co.kr/images/common/icon_cal1.png" alt="날짜선택" /></a> ')});$(".carSlct .carSelTit a").click(function(){$(".calendar").hide();$("body").unbind("touchmove")})}});function startDate(a){dateFoucsObj=a;cDate($(a).parent().children(".cDatepicker"));$(".calendar").show();$(".calSelTit").find("h4").focus();$("body").bind("touchmove",function(b){b.preventDefault()});loaded()}function loaded(){myScroll=new iScroll("year",{lockDirection:true,vscollerBar:false});idx=$("#year li.on").index();myScroll.scrollToElement("li.on",0);idx=$("#month li.on").index();myScroll2=new iScroll("month",{lockDirection:true,vscollerBar:false});myScroll2.scrollToElement("li.on",0);idx=$("#day li.on").index();myScroll3=new iScroll("day",{lockDirection:true,vscollerBar:false});myScroll3.scrollToElement("li.on",0);$(".calSelTit").find("a").eq(0).focus()}function cDate(obj){dateObj=obj;var dateVal=$(obj).val().replace(/\-/gi,"");var startDate=$(obj).attr("date-min");var endDate=$(obj).attr("date-max");var defaultDate=$(obj).attr("date-default");if(defaultDate!=null&&defaultDate!=""){dateVal=defaultDate.replace(/\-/gi,"")}var startDateFlag=false;var endDateFlag=false;if(startDate!=undefined&&startDate!=""){startDateFlag=true}if(endDate!=undefined&&endDate!=""){endDateFlag=true}var startYear=now.getFullYear()-6;var endYear=now.getFullYear()+20;var startMonth=1;var endMonth=12;var startDay=1;var endDay=(new Date(now.getFullYear(),now.getMonth()+1,0)).getDate();var minYear=startYear;var minMonth=startMonth;var minDay=startDay;var maxYear=endYear;var maxMonth=endMonth;var maxDay=endDay;if(startDateFlag){startDate=startDate.replace(/\-/gi,"");minYear=startDate.substring(0,4);minMonth=startDate.substring(4,6);minDay=startDate.substring(6,8);startYear=minYear;if(eval(minMonth)<10){startMonth=minMonth.substring(1,2)}else{startMonth=minMonth}if(eval(minDay)<10){startDay=minDay.substring(1,2)}else{startDay=minDay}}else{startDate=startYear;if(eval(startMonth)<10){startDate+="0"+startMonth}else{startDate+=""+startMonth}if(eval(startDay)<10){startDate+="0"+startDay}else{startDate+=""+startDay}}if(endDateFlag){endDate=endDate.replace(/\-/gi,"");maxYear=endDate.substring(0,4);maxMonth=endDate.substring(4,6);maxDay=endDate.substring(6,8);endYear=maxYear;if(eval(maxMonth)<10){endMonth=maxMonth.substring(1,2)}else{endMonth=maxMonth}if(eval(maxDay)<10){endDay=maxDay.substring(1,2)}else{endDay=maxDay}}else{endDate=endYear;if(eval(endMonth)<10){endDate+="0"+endMonth}else{endDate+=""+endMonth}if(eval(endDay)<10){endDate+="0"+endDay}else{endDate+=""+endDay}}var checkYear=now.getFullYear();var checkMonth=now.getMonth()+1;var checkDay=now.getDate();if(dateVal.length==8){checkYear=dateVal.substring(0,4);checkMonth=dateVal.substring(4,6);checkDay=dateVal.substring(6,8);if(eval(checkMonth)<10){checkMonth=checkMonth.substring(1,2)}if(eval(checkDay)<10){checkDay=checkDay.substring(1,2)}}var checkDate=checkYear;if(eval(checkMonth)<10){checkDate+="0"+checkMonth}else{checkDate+=""+checkMonth}if(eval(checkDay)<10){checkDate+="0"+checkDay}else{checkDate+=""+checkDay}if(eval(startDate)>eval(checkDate)||eval(endDate)<eval(checkDate)){checkYear=startYear;checkMonth=startMonth;checkDay=startDay}if(checkYear!=startYear&&checkYear!=endYear){startMonth=deStartMonth;endMonth=deEndMonth;startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{if(checkYear==startYear&&checkYear!=endYear){endMonth=deEndMonth;if(checkMonth==startMonth&&checkMonth!=endMonth){endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{if(checkMonth!=startMonth&&checkMonth!=endMonth){startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}}}else{if(checkYear!=startYear&&checkYear==endYear){startMonth=deStartMonth;if(checkMonth!=startMonth&&checkMonth!=endMonth){startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{if(checkMonth!=startMonth&&checkMonth==endMonth){startDay=deStartDay}else{startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}}}else{if(checkMonth!=startMonth&&checkMonth!=endMonth){startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{if(checkMonth!=startMonth&&checkMonth==endMonth){startDay=deStartDay}else{if(checkMonth==startMonth&&checkMonth!=endMonth){startDay=parseInt(minDay,10);endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}}}}}}var html="";var checkClass="";html+='<div class="calendar" style="display:none;">';html+='<div class="calSel">';html+='<div class="calSelTit">';html+='<h4 tabindex="0">날짜 선택</h4>';html+="</div>";html+='<div class="dateWrap">';html+="<dl>";html+="<dt>년</dt>";html+="<dd>";html+='<div id="year" class="datePick">';html+="<ul>";for(var y=startYear;y<=endYear;y++){if(y==checkYear){checkClass="on"}else{checkClass=""}html+='<li class="'+checkClass+'"><a href="#none" onclick="cDateYearClick(this)">'+y+"</a></li>"}html+="<li>&nbsp;</li>";html+='<li class="bdNone">&nbsp;</li>';html+='<li class="bdNone">&nbsp;</li>';html+='<li class="bdNone">&nbsp;</li>';html+="</ul>";html+="</div>";html+="</dd>";html+="</dl>";html+="<dl>";html+="<dt>월</dt>";html+="<dd>";html+='<div id="month" class="datePick">';html+="<ul>";for(var m=eval(startMonth);m<=eval(endMonth);m++){if(m==checkMonth){checkClass="on"}else{checkClass=""}html+='<li class="'+checkClass+'"><a href="#none" onclick="cDateMonthClick(this)">'+m+"</a></li>"}html+="<li>&nbsp;</li>";html+='<li class="bdNone">&nbsp;</li>';html+='<li class="bdNone">&nbsp;</li>';html+='<li class="bdNone">&nbsp;</li>';html+="</ul>";html+="</div>";html+="</dd>";html+="</dl>";html+="<dl>";html+="<dt>일</dt>";html+="<dd>";html+='<div id="day" class="datePick">';html+="<ul>";for(var d=eval(startDay);d<=eval(endDay);d++){if(d==checkDay){checkClass="on"}else{checkClass=""}html+='<li class="'+checkClass+'"><a href="#none" onclick="cDateDaysClick(this)">'+d+"</a></li>"}html+="<li>&nbsp;</li>";html+='<li class="bdNone">&nbsp;</li>';html+='<li class="bdNone">&nbsp;</li>';html+='<li class="bdNone">&nbsp;</li>';html+="</ul>";html+="</div>";html+="</dd>";html+="</dl>";html+="</div>";html+='<span class="canBtn"><a href="#none" onclick="cDateSet();" title="날짜를 선택하고 현재 창을 닫습니다.">확인</a></span>';html+='<span class="canBtn2"><a href="#none" onclick="cDateClose();" title="현재 창을 닫고 돌아갑니다.">취소</a></span>';html+="</div>";html+="</div>";$("body").append(html)}function cDateYearClick(a){$("#year li").removeClass("on");$("#month li").removeClass("on");$("#day li").removeClass("on");$(a).parent("li").addClass("on");cDateMonthChange()}function cDateMonthClick(a){$("#month li").removeClass("on");$(a).parent("li").addClass("on");cDateDaysChange()}function cDateMonthChange(){var now=new Date();var checkYear=$("#year li.on").text();var checkMonth=1;var checkDay=1;var startDate=$(dateObj).attr("date-min");var endDate=$(dateObj).attr("date-max");var startDateFlag=false;var endDateFlag=false;if(startDate!=undefined&&startDate!=""){startDateFlag=true}if(endDate!=undefined&&endDate!=""){endDateFlag=true}var startYear=now.getFullYear()-6;var endYear=now.getFullYear()+20;var startMonth=1;var endMonth=12;var startDay=1;var endDay=(new Date(now.getFullYear(),now.getMonth()+1,0)).getDate();var minYear=startYear;var minMonth=startMonth;var minDay=startDay;var maxYear=endYear;var maxMonth=endMonth;var maxDay=endDay;if(startDateFlag){startDate=startDate.replace(/\-/gi,"");minYear=startDate.substring(0,4);minMonth=startDate.substring(4,6);minDay=startDate.substring(6,8);startYear=minYear;if(eval(minMonth)<10){startMonth=minMonth.substring(1,2)}else{startMonth=minMonth}if(eval(minDay)<10){startDay=minDay.substring(1,2)}else{startDay=minDay}}else{startDate=startYear;if(eval(startMonth)<10){startDate+="0"+startMonth}else{startDate+=""+startMonth}if(eval(startDay)<10){startDate+="0"+startDay}else{startDate+=""+startDay}}if(endDateFlag){endDate=endDate.replace(/\-/gi,"");maxYear=endDate.substring(0,4);maxMonth=endDate.substring(4,6);maxDay=endDate.substring(6,8);endYear=maxYear;if(eval(maxMonth)<10){endMonth=maxMonth.substring(1,2)}else{endMonth=maxMonth}if(eval(maxDay)<10){endDay=maxDay.substring(1,2)}else{endDay=maxDay}}else{endDate=endYear;if(eval(endMonth)<10){endDate+="0"+endMonth}else{endDate+=""+endMonth}if(eval(endDay)<10){endDate+="0"+endDay}else{endDate+=""+endDay}}var checkDate=checkYear;if(eval(checkMonth)<10){checkDate+="0"+checkMonth}else{checkDate+=""+checkMonth}if(eval(checkDay)<10){checkDate+="0"+checkDay}else{checkDate+=""+checkDay}if(eval(startDate)>eval(checkDate)||eval(endDate)<eval(checkDate)){checkMonth=startMonth;checkDay=startDay}if(checkYear!=startYear&&checkYear!=endYear){startMonth=deStartMonth;endMonth=deEndMonth;startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{if(checkYear==startYear&&checkYear!=endYear){endMonth=deEndMonth;if(checkMonth==startMonth&&checkMonth!=endMonth){endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{if(checkMonth!=startMonth&&checkMonth!=endMonth){startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}}}else{if(checkYear!=startYear&&checkYear==endYear){startMonth=deStartMonth;if(checkMonth!=startMonth&&checkMonth!=endMonth){startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{if(checkMonth!=startMonth&&checkMonth==endMonth){startDay=deStartDay}else{startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}}}else{if(checkMonth!=startMonth&&checkMonth!=endMonth){startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{if(checkMonth!=startMonth&&checkMonth==endMonth){startDay=deStartDay}else{if(checkMonth==startMonth&&checkMonth!=endMonth){startDay=parseInt(minDay,10);endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}}}}}}var monthHtml="";var checkClass="";monthHtml+="<ul>";for(var m=eval(startMonth);m<=eval(endMonth);m++){if(m==startMonth){checkClass="on"}else{checkClass=""}monthHtml+='<li class="'+checkClass+'"><a href="#none" onclick="cDateMonthClick(this)">'+m+"</a></li>"}monthHtml+="<li>&nbsp;</li>";monthHtml+='<li class="bdNone">&nbsp;</li>';monthHtml+='<li class="bdNone">&nbsp;</li>';monthHtml+='<li class="bdNone">&nbsp;</li>';monthHtml+="</ul>";$("#month").html(monthHtml);myScroll2=new iScroll("month",{lockDirection:true});var dayHtml="";dayHtml+="<ul>";for(var d=eval(startDay);d<=eval(endDay);d++){if(d==startDay){checkClass="on"}else{checkClass=""}dayHtml+='<li class="'+checkClass+'"><a href="#none" onclick="cDateDaysClick(this)">'+d+"</a></li>"}dayHtml+="<li>&nbsp;</li>";dayHtml+='<li class="bdNone">&nbsp;</li>';dayHtml+='<li class="bdNone">&nbsp;</li>';dayHtml+='<li class="bdNone">&nbsp;</li>';dayHtml+="</ul>";$("#day").html(dayHtml);myScroll3=new iScroll("day",{lockDirection:true});myScroll3.scrollToElement("li:nth-child(0)",0)}function cDateDaysClick(a){$("#day li").removeClass("on");$(a).parent("li").addClass("on")}function cDateDaysChange(){var now=new Date();var checkYear=$("#year li.on").text();var checkMonth=$("#month li.on").text();var checkDay=1;var startDate=$(dateObj).attr("date-min");var endDate=$(dateObj).attr("date-max");var startDateFlag=false;var endDateFlag=false;if(startDate!=undefined&&startDate!=""){startDateFlag=true}if(endDate!=undefined&&endDate!=""){endDateFlag=true}var startYear=now.getFullYear()-6;var endYear=now.getFullYear()+20;var startMonth=1;var endMonth=12;var startDay=1;var endDay=(new Date(checkYear,checkMonth,0)).getDate();var minYear=startYear;var minMonth=startMonth;var minDay=startDay;var maxYear=endYear;var maxMonth=endMonth;var maxDay=endDay;if(startDateFlag){startDate=startDate.replace(/\-/gi,"");minYear=startDate.substring(0,4);minMonth=startDate.substring(4,6);minDay=startDate.substring(6,8);startYear=minYear;if(eval(minMonth)<10){startMonth=minMonth.substring(1,2)}else{startMonth=minMonth}if(eval(minDay)<10){startDay=minDay.substring(1,2)}else{startDay=minDay}}else{startDate=startYear;if(eval(startMonth)<10){startDate+="0"+startMonth}else{startDate+=""+startMonth}if(eval(startDay)<10){startDate+="0"+startDay}else{startDate+=""+startDay}}if(endDateFlag){endDate=endDate.replace(/\-/gi,"");maxYear=endDate.substring(0,4);maxMonth=endDate.substring(4,6);maxDay=endDate.substring(6,8);endYear=maxYear;if(eval(maxMonth)<10){endMonth=maxMonth.substring(1,2)}else{endMonth=maxMonth}if(eval(maxDay)<10){endDay=maxDay.substring(1,2)}else{endDay=maxDay}}else{endDate=endYear;if(eval(endMonth)<10){endDate+="0"+endMonth}else{endDate+=""+endMonth}if(eval(endDay)<10){endDate+="0"+endDay}else{endDate+=""+endDay}}var checkDate=checkYear;if(eval(checkMonth)<10){checkDate+="0"+checkMonth}else{checkDate+=""+checkMonth}if(eval(checkDay)<10){checkDate+="0"+checkDay}else{checkDate+=""+checkDay}if(eval(startDate)>eval(checkDate)||eval(endDate)<eval(checkDate)){checkYear=startYear;checkMonth=startMonth;checkDay=startDay}if(checkYear!=startYear&&checkYear!=endYear){startMonth=deStartMonth;endMonth=deEndMonth;startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{if(checkYear==startYear&&checkYear!=endYear){endMonth=deEndMonth;if(checkMonth==startMonth&&checkMonth!=endMonth){endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{if(checkMonth!=startMonth&&checkMonth!=endMonth){startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}}}else{if(checkYear!=startYear&&checkYear==endYear){startMonth=deStartMonth;if(checkMonth!=startMonth&&checkMonth!=endMonth){startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{if(checkMonth!=startMonth&&checkMonth==endMonth){startDay=deStartDay}else{startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}}}else{if(checkMonth!=startMonth&&checkMonth!=endMonth){startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{if(checkMonth!=startMonth&&checkMonth==endMonth){startDay=deStartDay}else{if(checkMonth==startMonth&&checkMonth!=endMonth){startDay=parseInt(minDay,10);endDay=(new Date(checkYear,checkMonth,0)).getDate()}else{startDay=deStartDay;endDay=(new Date(checkYear,checkMonth,0)).getDate()}}}}}}var html="";html+="<ul>";for(var d=eval(startDay);d<=eval(endDay);d++){if(d==startDay){checkClass="on"}else{checkClass=""}html+='<li class="'+checkClass+'"><a href="#none" onclick="cDateDaysClick(this)">'+d+"</a></li>"}html+="<li>&nbsp;</li>";html+='<li class="bdNone">&nbsp;</li>';html+='<li class="bdNone">&nbsp;</li>';html+='<li class="bdNone">&nbsp;</li>';html+="</ul>";$("#day").html(html);myScroll3=new iScroll("day",{lockDirection:true})}function cDateSet(){var f=$("#day li.on").text();var a=$("#year li.on").text();var c=$("#month li.on").text();if(f.length==1){f="0"+f}if(c.length==1){c="0"+c}var b=a+"-"+c+"-"+f;$(dateObj).val("");$(dateObj).val(b);cDateClose();try{$(dateObj).change()}catch(d){}$(dateFoucsObj).focus()}function cDateClose(){$(".calendar").hide();$(dateFoucsObj).focus();$("body").unbind("touchmove");$(".calendar").remove()};